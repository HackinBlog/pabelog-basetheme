{"version":3,"sources":["day8/re_frame_10x/view/timing.cljs"],"sourcesContent":["(ns day8.re-frame-10x.view.timing\n  (:require [devtools.prefs]\n            [devtools.formatters.core]\n            [day8.re-frame-10x.inlined-deps.re-frame.v0v10v6.re-frame.core :as rf]\n            [day8.re-frame-10x.utils.re-com :as rc :refer [css-join]]\n            [day8.re-frame-10x.common-styles :as common]\n            [day8.re-frame-10x.view.components :as components]))\n\n(def timing-styles\n  [:#--re-frame-10x--\n   [:.timing-details\n    {:margin-top   common/gs-31s\n     :margin-right common/gs-19s}]\n   [:.timing-details--line\n    {:margin \"1em 0\"}]\n\n   [:p :ol\n    {:max-width \"26em\"}]\n   [:ol\n    {\"-webkit-padding-start\" \"20px\"}]\n   [:li\n    {:margin \"0 0 1em 0\"}]\n\n   [\".rft-tag__timing\"\n    {:background-color \"#ECEDF0\"\n     :border           (str \"1px solid \" common/border-line-color)\n     :font-weight      \"normal\"\n     :font-size        \"14px\"\n     :width            \"63px\"}]\n\n   [\".timing-elapsed-panel\"\n    {:padding \"12px 12px 12px 0px\"\n     :margin  (css-join common/gs-7s \"0px\")}]\n   [\".timing-part-panel\"\n    (merge (common/panel-style \"3px\")\n           {:padding  common/gs-12s\n            :margin   (css-join common/gs-7s \"0px\")\n            :overflow \"hidden\"})]\n   ])\n\n(defn timing-tag [label]\n  [components/tag \"rft-tag__timing\" label])\n\n(defn timing-section\n  [label time]\n  [rc/v-box\n   :align :center\n   :gap \"3px\"\n   ;; TODO: detect <1 ms timing here, to distinguish between none at all, and rounding to 0.\n   :children [[rc/label :class \"bm-textbox-label\" :label label]\n              [timing-tag (cond\n                            (nil? time) \"-\"\n                            (= time 0) (str \"0ms\")\n                            (< time 0.1) (str \"<0.1ms\")\n                            (< time 1) (str (.toFixed time 1) \"ms\")\n                            (some? time) (str (js/Math.round time) \"ms\"))]]])\n\n(defn render []\n  (let [timing-data-available? @(rf/subscribe [:timing/data-available?])\n        event-processing-time  @(rf/subscribe [:timing/event-processing-time])]\n    (if timing-data-available?\n      [rc/v-box\n       :class \"timing-details\"\n       :children [[rc/h-box\n                   :class \"timing-elapsed-panel\"\n                   :align :end\n                   :children [[timing-section \"elapsed\" @(rf/subscribe [:timing/total-epoch-time])]\n                              [rc/hyperlink-href\n                               :label \"guide me to greatness\"\n                               :style {:margin-left common/gs-19s}\n                               :attr {:rel \"noopener noreferrer\"}\n                               :target \"_blank\"\n                               :href \"https://github.com/Day8/re-frame-10x/blob/master/docs/HyperlinkedInformation/UnderstandingTiming.md\"]]]\n                  [rc/h-box\n                   :gap common/gs-12s\n                   :class \"timing-part-panel\"\n                   :align :center\n                   :children [[rc/v-box\n                               :align :center\n                               :width common/gs-81s\n                               :children [[:span \"event\"] [:span \"processing\"]]]\n                              [timing-section \"total\" (:timing/event-total event-processing-time)]\n                              [:span \"=\"]\n                              [timing-section \"handler\" (:timing/event-handler event-processing-time)]\n                              [:span \"+\"]\n                              [timing-section \"effects\" (:timing/event-effects event-processing-time)]\n                              #_[:span \"+\"]\n                              #_[timing-section \"other int.\" (:timing/event-interceptors event-processing-time)]\n                              [:span \"+\"]\n                              [timing-section \"misc\" (:timing/event-misc event-processing-time)]]]\n                  (doall\n                    (for [frame (range 1 (inc @(rf/subscribe [:timing/animation-frame-count])))\n                          :let [frame-time @(rf/subscribe [:timing/animation-frame-time frame])]]\n                      (list\n                        ;^{:key (str \"af-line\" frame)}\n                        ;[rc/line :class \"timing-details--line\"]\n                        ^{:key (str \"af\" frame)}\n                        [rc/h-box\n                         :align :center\n                         :class \"timing-part-panel\"\n                         :gap common/gs-12s\n                         :children\n                         [[rc/v-box\n                           :align :center\n                           :width common/gs-81s\n                           :children [[:span \"animation\"] [:span \"frame\"] [:span \"#\" frame]]]\n                          [timing-section \"total\" (:timing/animation-frame-total frame-time)]\n                          [:span \"=\"]\n                          [timing-section \"subs\" (:timing/animation-frame-subs frame-time)]\n                          [:span \"+\"]\n                          [timing-section \"views\" (:timing/animation-frame-render frame-time)]\n                          [:span \"+\"]\n                          [timing-section \"react, etc\" (:timing/animation-frame-misc frame-time)]]])))]]\n      [rc/v-box\n       :class \"timing-details\"\n       :children [[:h1 \"No timing data currently available.\"]]])))\n"],"mappings":"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","names":["day8.re-frame-10x.view.timing/timing-styles","day8.re-frame-10x.common-styles/gs-31s","day8.re-frame-10x.common-styles/gs-19s","day8.re-frame-10x.common-styles/border-line-color","day8.re_frame_10x.utils.re_com.css_join.cljs$core$IFn$_invoke$arity$variadic","day8.re-frame-10x.common-styles/gs-7s","cljs.core.merge.cljs$core$IFn$_invoke$arity$variadic","day8.re-frame-10x.common-styles/panel-style","day8.re-frame-10x.common-styles/gs-12s","day8.re-frame-10x.view.timing/timing-tag","day8.re-frame-10x.view.components/tag","label","day8.re-frame-10x.view.timing/timing-section","day8.re-frame-10x.utils.re-com/v-box","day8.re-frame-10x.utils.re-com/label","time","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","js/Math.round","day8.re-frame-10x.view.timing/render","cljs.core/deref","G__19490","day8.re-frame-10x.inlined-deps.re-frame.v0v10v6.re-frame.core/subscribe","G__19492","timing-data-available?","day8.re-frame-10x.utils.re-com/h-box","G__19494","day8.re-frame-10x.utils.re-com/hyperlink-href","day8.re-frame-10x.common-styles/gs-81s","event-processing-time","cljs.core.doall.cljs$core$IFn$_invoke$arity$1","cljs.core/LazySeq","s__19498","cljs.core/seq","temp__5457__auto__","cljs.core/chunked-seq?","cljs.core/count","c__4432__auto__","cljs.core/chunk-buffer","size__4433__auto__","i__19499","cljs.core._nth.cljs$core$IFn$_invoke$arity$2","cljs.core/chunk-append","b__19500","cljs.core/chunk-cons","cljs.core/chunk","iter__19497","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","iter__4434__auto__","cljs.core.range.cljs$core$IFn$_invoke$arity$2","G__19514","G__19507","G__19510","frame","cljs.core/List","frame-time","cljs.core/chunk-first"]}